(function(e){function t(t){for(var a,o,r=t[0],l=t[1],i=t[2],u=0,d=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);b&&b(t);while(d.length)d.shift()();return c.push.apply(c,i||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,o=1;o<n.length;o++){var r=n[o];0!==s[r]&&(a=!1)}a&&(c.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},o={app:0},s={app:0},c=[];function r(e){return l.p+"js/"+({about:"about"}[e]||e)+"."+{about:"2468aee3","chunk-2d0ac41c":"a6ac7178"}[e]+".js"}function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n={about:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise((function(t,n){for(var a="css/"+({about:"about"}[e]||e)+"."+{about:"8c16e102","chunk-2d0ac41c":"31d6cfe0"}[e]+".css",s=l.p+a,c=document.getElementsByTagName("link"),r=0;r<c.length;r++){var i=c[r],u=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(u===a||u===s))return t()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){i=d[r],u=i.getAttribute("data-href");if(u===a||u===s)return t()}var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.onload=t,b.onerror=function(t){var a=t&&t.target&&t.target.src||s,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=a,delete o[e],b.parentNode.removeChild(b),n(c)},b.href=s;var p=document.getElementsByTagName("head")[0];p.appendChild(b)})).then((function(){o[e]=0})));var a=s[e];if(0!==a)if(a)t.push(a[2]);else{var c=new Promise((function(t,n){a=s[e]=[t,n]}));t.push(a[2]=c);var i,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=r(e);var d=new Error;i=function(t){u.onerror=u.onload=null,clearTimeout(b);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",d.name="ChunkLoadError",d.type=a,d.request=o,n[1](d)}s[e]=void 0}};var b=setTimeout((function(){i({type:"timeout",target:u})}),12e4);u.onerror=u.onload=i,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/notes/",l.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var d=0;d<i.length;d++)t(i[d]);var b=u;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"024a":function(e,t,n){},"14fd":function(e,t,n){"use strict";n("86b6")},"1c47":function(e,t,n){"use strict";n("337b")},2885:function(e,t,n){},"337b":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var a=n("7a23");const o={id:"nav"},s={id:"main"};function c(e,t,n,c,r,l){const i=Object(a["B"])("Nav"),u=Object(a["B"])("router-view");return Object(a["u"])(),Object(a["f"])(a["a"],null,[Object(a["g"])("div",o,[Object(a["j"])(i)]),Object(a["g"])("div",s,[Object(a["j"])(u)])],64)}const r={class:"nav"},l={class:"nav-router-links"},i={class:"nav-buttons"};function u(e,t,n,o,s,c){const u=Object(a["B"])("router-link");return Object(a["u"])(),Object(a["f"])("div",r,[Object(a["g"])("div",l,[Object(a["j"])(u,{to:"/"},{default:Object(a["H"])(()=>[Object(a["i"])("Notes")]),_:1}),Object(a["j"])(u,{to:"/about"},{default:Object(a["H"])(()=>[Object(a["i"])("About")]),_:1})]),Object(a["g"])("div",i,[e.$store.state.userIsAuthenticated?Object(a["e"])("",!0):(Object(a["u"])(),Object(a["f"])("a",{key:0,class:"menu-button",onClick:t[0]||(t[0]=t=>e.$store.dispatch("auth0Login"))},"Log in")),e.$store.state.userIsAuthenticated?(Object(a["u"])(),Object(a["f"])("a",{key:1,class:"menu-button",onClick:t[1]||(t[1]=t=>e.$store.dispatch("auth0Logout"))},"Log out")):Object(a["e"])("",!0)])])}var d={name:"Nav"},b=(n("14fd"),n("6b0d")),p=n.n(b);const h=p()(d,[["render",u]]);var O=h,m={name:"App",components:{Nav:O},mounted(){}};n("f049");const j=p()(m,[["render",c]]);var f=j,g=n("6605");const v={class:"home"};function k(e,t,n,o,s,c){const r=Object(a["B"])("Notes");return Object(a["u"])(),Object(a["f"])("div",v,[Object(a["j"])(r)])}var y=n("f125");const _={key:0};function N(e,t,n,o,s,c){return e.$store.state.all.length>0?(Object(a["u"])(!0),Object(a["f"])(a["a"],{key:0},Object(a["A"])(e.$store.state.all,(t,n)=>(Object(a["u"])(),Object(a["f"])("div",null,[0==n||e.$store.state.all[n-1]&&t.createdAt.substr(0,10)!=e.$store.state.all[n-1].createdAt.substr(0,10)?(Object(a["u"])(),Object(a["f"])("h3",_,Object(a["D"])(t.createdAt.substr(0,10)),1)):Object(a["e"])("",!0),Object(a["i"])(" "+Object(a["D"])(t.I),1)]))),256)):Object(a["e"])("",!0)}var S={};const I=p()(S,[["render",N]]);var A=I,T={name:"Home",components:{Notes:y["a"],ListByDate:A}};const C=p()(T,[["render",k]]);var B=C,w=(n("14d9"),n("5502"));const L=(e,t,n,a)=>{localStorage.getItem("access_token")||console.log("no access token");var o=new XMLHttpRequest;o.open(e,t,!0),o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Authorization","Bearer "+localStorage.getItem("access_token")),o.send(n),o.onreadystatechange=()=>{4==o.readyState&&"200"==o.status&&a(o.responseText)}};function D(e,t){const n=JSON.stringify({ids:e});L("POST","https://dinges-app.herokuapp.com/dinges/get",n,e=>{t(JSON.parse(e))})}function $(e,t){L("POST","https://dinges-app.herokuapp.com/ding",JSON.stringify(e),e=>{t(JSON.parse(e))})}function U(e,t){e.updatedAt=(new Date).toISOString(),L("PUT","https://dinges-app.herokuapp.com/ding/"+e._id,JSON.stringify(e),e=>{t(JSON.parse(e))})}function E(e,t){const n=JSON.stringify({email:e});L("POST","https://dinges-app.herokuapp.com/user/get",n,e=>{let n=JSON.parse(e);t(n||null)})}function x(e,t){const n=JSON.stringify({username:e});L("POST","https://dinges-app.herokuapp.com/user/name_check",n,e=>{let n="true"===e;t(n)})}function P(e,t,n){console.log(t);const a={email:e,username:t,O:[]};L("POST","https://dinges-app.herokuapp.com/user",JSON.stringify(a),e=>{n(e)})}function J(e,t){L("PUT","https://dinges-app.herokuapp.com/user/"+e._id,JSON.stringify(e),e=>{t(e)})}var H=n("b0af"),F=Object(w["a"])({state:{auth0:new H["a"].WebAuth({domain:"tijs-app.eu.auth0.com",clientID:"h2xPpZy7MyMG9Q1ZnjBofEZxF0dHUHDZ",redirectUri:"https://tijsvandenheuvel.github.io/notes/auth0callback",responseType:"token id_token",scope:"openid profile email",audience:"https://dinges-api"}),userIsAuthenticated:!1,userEmail:null,userData:null,userToBeCreated:!1,userNameAvailable:!0,all:[]},mutations:{setUserIsAuthenticated(e,t){e.userIsAuthenticated=t},getAllFromUserData(e){D(e.userData.O,t=>{e.all=t})},createNote(e,{note:t,callback:n}){let a={I:t,O:[]};$(a,t=>{e.all.push(t),e.userData.O.push(t._id),J(e.userData,()=>{}),n(t)})}},actions:{auth0Login(e){e.state.auth0.authorize()},auth0HandleAuthentication(e){e.state.auth0.parseHash((t,n)=>{if(n&&n.accessToken&&n.idToken){let a=JSON.stringify((new Date).getTime()+1e3*n.expiresIn);localStorage.setItem("access_token",n.accessToken),localStorage.setItem("id_token",n.idToken),localStorage.setItem("expires_at",a),e.dispatch("auth0getUserEmail"),Z.replace("/"),t&&(alert("login failed"),Z.replace("/"),console.log(t))}})},auth0getUserEmail(e){localStorage.getItem("access_token")&&e.state.auth0.client.userInfo(localStorage.getItem("access_token"),(function(t,n){n&&(e.state.userEmail=n.email)}))},auth0Logout(e){localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),window.location.href="https://tijs-app.eu.auth0.com/v2/logout?returnTo=https://tijsvandenheuvel.github.io/notes&client_id=h2xPpZy7MyMG9Q1ZnjBofEZxF0dHUHDZ"},checkUserNameAvailabilityAndTrySave(e,t){x(t,n=>{e.state.userNameAvailable=n,n&&P(e.state.userEmail,t,()=>{e.state.userToBeCreated=!1,e.dispatch("init")})})},init(e){localStorage.getItem("access_token")&&E(e.state.userEmail,t=>{t?(e.state.userData=t,e.commit("getAllFromUserData")):(e.state.userToBeCreated=!0,console.log("creating user"))})},updateNote(e,{note:t,callback:n}){U(t,t=>{e.dispatch("init",()=>{}),n(t)})},getOrCreateDingByValue(e,{val:t,callback:n}){let a=e.state.all.find(e=>e.I.toLowerCase().replace("?","")==t.toLowerCase().replace("?",""));if(0==e.state.all.length)console.log("no state"),n(null);else if(a)n(a);else{let a=e.state.all.find(e=>e._id==t);a?n(a):e.commit("createNote",{note:t,callback:e=>{n(e)}})}},addLinkToNote(e,{note:t,link:n,callback:a}){e.dispatch("getOrCreateDingByValue",{val:n,callback:n=>{let o={};o["link"]=n._id,t.O.push(o),e.dispatch("updateNote",{note:t,callback:e=>{a()}})}})}},modules:{}});const M=[{path:"/",name:"Home",component:B},{path:"/auth0callback",component:B},{path:"/about",name:"About",component:()=>n.e("about").then(n.bind(null,"f820"))},{path:"/notes",name:"Notes",component:()=>n.e("chunk-2d0ac41c").then(n.bind(null,"1986"))}],V=Object(g["a"])({history:Object(g["b"])("/notes/"),routes:M});V.beforeEach((e,t,n)=>{e.matched.some(e=>"/auth0callback"==e.path)&&F.dispatch("auth0HandleAuthentication");let a=!1;if(localStorage.getItem("access_token")&&localStorage.getItem("id_token")&&localStorage.getItem("expires_at")){let e=JSON.parse(localStorage.getItem("expires_at"));a=(new Date).getTime()<e}F.commit("setUserIsAuthenticated",a),e.matched.some(e=>e.meta.requiresAuth)?a?(F.commit("setUserIsAuthenticated",!0),n()):V.replace("/"):n()});var Z=V;Object(a["c"])(f).use(F).use(Z).mount("#app")},"685f":function(e,t,n){},"6db6":function(e,t,n){"use strict";n("b98a")},"86b6":function(e,t,n){},b98a:function(e,t,n){},e878:function(e,t,n){"use strict";n("685f")},e8df:function(e,t,n){"use strict";n("2885")},f049:function(e,t,n){"use strict";n("024a")},f125:function(e,t,n){"use strict";var a=n("7a23");const o={key:0,class:"notes"},s={class:"user"},c={key:0,class:"user-data"},r={key:1,class:"create-user"};function l(e,t,n,l,i,u){const d=Object(a["B"])("CreateUser"),b=Object(a["B"])("NotesList"),p=Object(a["B"])("NewNote");return e.$store.state.userIsAuthenticated&&this.$store.state.userEmail?(Object(a["u"])(),Object(a["f"])("div",o,[Object(a["g"])("div",s,[e.$store.state.userData?(Object(a["u"])(),Object(a["f"])("div",c,[Object(a["g"])("h2",null,"Hello "+Object(a["D"])(e.$store.state.userData.username),1)])):Object(a["e"])("",!0),e.$store.state.userToBeCreated?(Object(a["u"])(),Object(a["f"])("div",r,[Object(a["j"])(d)])):Object(a["e"])("",!0)]),Object(a["j"])(b),Object(a["j"])(p)])):Object(a["e"])("",!0)}const i=e=>(Object(a["x"])("data-v-64923c0c"),e=e(),Object(a["v"])(),e),u=i(()=>Object(a["g"])("br",null,null,-1)),d=i(()=>Object(a["g"])("span",null,"Choose a Username: ",-1)),b=i(()=>Object(a["g"])("br",null,null,-1)),p=i(()=>Object(a["g"])("br",null,null,-1)),h={key:0,id:"warning"},O=i(()=>Object(a["g"])("br",null,null,-1)),m=i(()=>Object(a["g"])("br",null,null,-1)),j=i(()=>Object(a["g"])("br",null,null,-1));function f(e,t,n,o,s,c){return Object(a["u"])(),Object(a["f"])(a["a"],null,[u,d,b,Object(a["I"])(Object(a["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.userName=e),onKeyup:t[1]||(t[1]=Object(a["J"])(e=>c.trySave(),["enter"]))},null,544),[[a["F"],s.userName]]),p,Object(a["g"])("button",{class:"btn",onClick:t[2]||(t[2]=e=>c.trySave())},"Save"),e.$store.state.userNameAvailable?Object(a["e"])("",!0):(Object(a["u"])(),Object(a["f"])("div",h,[O,Object(a["i"])(" This username is unavailable ")])),m,j],64)}var g={data(){return{userName:"",userNameAvailable:!0}},methods:{trySave(){this.$store.dispatch("checkUserNameAvailabilityAndTrySave",this.userName)}}},v=(n("e8df"),n("6b0d")),k=n.n(v);const y=k()(g,[["render",f],["__scopeId","data-v-64923c0c"]]);var _=y;const N={class:"notes-list"},S=["onClick"],I={class:"active-note-line"},A={class:"note-text"},T=["onUpdate:modelValue","onKeypress"],C=["onUpdate:modelValue"],B={key:0,class:"note-buttons"},w=["onClick"];function L(e,t,n,o,s,c){const r=Object(a["B"])("LinkList");return e.$store.state.all.length>0?(Object(a["u"])(!0),Object(a["f"])(a["a"],{key:0},Object(a["A"])(e.$store.state.all,(e,n)=>(Object(a["u"])(),Object(a["f"])("div",N,[Object(a["g"])("div",{class:Object(a["q"])(["card",{active:e==s.selected_note}]),onClick:t=>c.select(e)},[Object(a["g"])("div",I,[Object(a["g"])("span",A,[e==s.selected_note?Object(a["I"])((Object(a["u"])(),Object(a["f"])("input",{key:0,class:"edit-note-input","onUpdate:modelValue":t=>e.I=t,onKeypress:Object(a["J"])(t=>c.editNote(e),["enter"])},null,40,T)),[[a["F"],e.I]]):Object(a["I"])((Object(a["u"])(),Object(a["f"])("input",{key:1,class:"edit-note-input","onUpdate:modelValue":t=>e.I=t,readonly:""},null,8,C)),[[a["F"],e.I]])]),e==s.selected_note?(Object(a["u"])(),Object(a["f"])("span",B,[Object(a["g"])("button",{class:"edit-enter-button",onClick:t=>c.editNote(e)},"↵",8,w),Object(a["g"])("button",{class:"add-button",onClick:t[0]||(t[0]=e=>c.toggleAddingLink())}," + ")])):Object(a["e"])("",!0)]),Object(a["j"])(r,{toAdd:e==s.selected_note&&s.add_link_to_selected_note,note:e},null,8,["toAdd","note"])],10,S)]))),256)):Object(a["e"])("",!0)}const D={class:"active-note-links"},$={class:"links-list"},U={key:0,class:"links-list"};function E(e,t,n,o,s,c){const r=Object(a["B"])("InputBar");return Object(a["u"])(),Object(a["f"])("div",D,[(Object(a["u"])(!0),Object(a["f"])(a["a"],null,Object(a["A"])(n.note.O,e=>(Object(a["u"])(),Object(a["f"])("div",$,[Object(a["g"])("li",null,Object(a["D"])(c.getDingByLink(e).I),1)]))),256)),n.toAdd?(Object(a["u"])(),Object(a["f"])("li",U,[Object(a["j"])(r,{class:"input-bar",onCommit:c.AddLinkToSelectedNote},null,8,["onCommit"])])):Object(a["e"])("",!0)])}const x={class:"input-bar"};function P(e,t,n,o,s,c){return Object(a["u"])(),Object(a["f"])("div",x,[Object(a["I"])(Object(a["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.value=e),onKeypress:t[1]||(t[1]=Object(a["J"])(e=>c.commit(),["enter"]))},null,544),[[a["F"],s.value]]),Object(a["g"])("button",{class:"enter-button",onClick:t[2]||(t[2]=e=>c.commit())},"↵")])}var J={name:"InputBar",props:[],data(){return{value:""}},methods:{commit(){this.$emit("commit",this.value),this.value=""}}};n("1c47");const H=k()(J,[["render",P],["__scopeId","data-v-028e01bf"]]);var F=H,M={components:{InputBar:F},props:["note","toAdd"],data(){return{}},methods:{getDingByLink(e){var t;let n=Object.values(e)[0],a=null!==(t=this.$store.state.all.filter(e=>e._id==n)[0])&&void 0!==t?t:{I:"! "+n};return"!"==a.I[0]?(console.log("ding not found"),!1):a},AddLinkToSelectedNote(e){this.note&&e.length>0&&this.$store.dispatch("addLinkToNote",{note:this.note,link:e,callback:e=>{}})}}};n("6db6");const V=k()(M,[["render",E]]);var Z=V,q={components:{LinkList:Z},data(){return{selected_note:null,add_link_to_selected_note:!1,new_link:""}},methods:{getDingByLink(e){var t;let n=Object.values(e)[0],a=null!==(t=this.$store.state.all.filter(e=>e._id==n)[0])&&void 0!==t?t:{I:"! "+n};return"!"==a.I[0]?(console.log("ding not found"),!1):a},select(e){this.selected_note!=e&&(this.selected_note=e,this.add_link_to_selected_note=!1)},deselect(){this.selected_note=null},editNote(e){this.$store.dispatch("updateNote",{note:e,callback:e=>{}}),this.deselect()},toggleAddingLink(){this.add_link_to_selected_note=!this.add_link_to_selected_note}},mounted(){this.$store.dispatch("init")}};n("e878");const K=k()(q,[["render",L]]);var R=K;function z(e,t,n,o,s,c){const r=Object(a["B"])("InputBar");return Object(a["u"])(),Object(a["d"])(r,{onCommit:c.createNote},null,8,["onCommit"])}var G={components:{InputBar:F},data(){return{}},methods:{createNote(e){e.length>0&&(this.$store.commit("createNote",{note:e,callback:e=>{}}),this.new_note="")}}};const Q=k()(G,[["render",z]]);var W=Q,X={name:"Notes",components:{CreateUser:_,NotesList:R,NewNote:W},data(){return{}},methods:{},beforeCreate(){this.$store.state.userIsAuthenticated&&(this.$store.state.userEmail||this.$store.dispatch("auth0getUserEmail"))}};const Y=k()(X,[["render",l]]);t["a"]=Y}});
//# sourceMappingURL=app.608a107e.js.map